<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>天猫弹性导航条 - 练习 - 第1遍</title>
    <style>

        * {
            margin: 0;
            padding: 0;
        }

        body {
            background-color: pink;
        }

        nav {
            width: 900px;
            height: 63px;
            background: white url("images/doubleEleven.png") no-repeat right center;

            border-radius: 10px;
            margin: 100px auto;

            position: relative;
        }

        ul {
            list-style: none;
            position: relative;
            /*
                设置相对定位的目的是让ul子元素li里的文字能够显示在天猫logo的上层，
                因为相对定位不脱离标准流，而绝对定位会脱离标准流、其层级高于标准流；



            关于定位的相关知识点：

            相对定位：相对于自己以前在标准流中的位置来移动；

            注意点：

                相对定位不脱离标准流，会继续在标准流中占用一份空间；
                在同一个方向上（左右、上下）的定位只能使用一个，即不能同时设置左和右，或上和下；
                由于相对定位不脱离标准流，在其中是区分块级元素、行内元素、块级行内元素的；
                给相对定位的元素设置margin/padding时，其margin/padding是基于其在标准流原来占用的空间来计算的；

            应用场景：

                1 用于微调元素位置（示例中，input和vcode图片未能对齐，设置vcode图片的相对定位并微调top直到对齐input文本框（之前用的方法是把input和img放在一个div中，input左浮动、img右浮动，也可达到两个元素顶部对齐的效果）；

                2 配合绝对定位使用（“子绝父相”的应用场景）；


            绝对定位的注意点：

               绝对定位的元素是脱离标准流的；与浮动流类似，不区分block/inline/inline-block；

               默认情况下，无论元素是否有祖先元素，都会以body作为参考点来定位；

               若绝对定位元素有祖先元素，且祖先元素（各级祖先均可）也是定位流（除了静态定位之外），那么绝对定位元素就会以祖先元素为参考点；

               若绝对定位元素有多个祖先元素均为定位流，则它的定位是以离它最近的祖先为参考点；

               若绝对定位元素以body为参考点，则实际上是以网页首屏（打开页面后第一眼看到的）宽度和高度为参考点，而非以整个网页的宽高为参考点，且会随着浏览器的缩放而自动调适到定位点；

               绝对定位元素会忽略祖先元素的padding；

            */

        }
        
        ul li {
            width: 88px;
            height: 63px;
            line-height: 70px;
            text-align: center;
            cursor: pointer;

            float: left;
        }

        #tmall_logo {
            display: inline-block;
            width: 88px;
            height: 63px;
            background: url("images/tMall.png") no-repeat;

            position: absolute;
            /* 绝对定位使得天猫logo可以浮动在ul/li上面 */
        }

    </style>
</head>
<body>

<nav id="tmall_nav">
    <span id="tmall_logo"></span>
    <ul>
        <li>双11狂欢</li>
        <li>服装会场</li>
        <li>数码家电</li>
        <li>家具建材</li>
        <li>母婴童装</li>
        <li>手机会场</li>
        <li>美妆会场</li>
        <li>进口会场</li>
        <li>飞猪旅行</li>
    </ul>
</nav>


<script>

    window.addEventListener('load', function () {

        function $ (id) {   // 简化 getElementByID 方法的函数；
            return typeof id === 'string' ? document.getElementById(id) : null
        }

        // 获取所需标签：
        var tmall_nav = $('tmall_nav');
        var tmall_logo = $('tmall_logo');
        var ul = tmall_nav.children[1];
        var allLi = ul.children;

        // 记录logo起始位置：
        var logoInitialPosX = 0, logoMoveToPosX = 0;

        // 遍历li，设置li标签的鼠标 enter/out/click 事件：
        for (var i = 0; i < allLi.length; i ++) {
            var li = allLi[i];

            li.addEventListener('mouseenter', function () {
                logoMoveToPosX = this.offsetLeft;     // 鼠标进入时，设置logo移动的距离，为这个li的左边框到其定位父元素或body的左边界的长度；
            });

            li.addEventListener('click', function () {
               logoInitialPosX = this.offsetLeft;    //  若鼠标点击该li，则重置logo的显示起始位置为当前li的左边界；
            });

            li.addEventListener('mouseout', function () {
                logoMoveToPosX = logoInitialPosX;  //  鼠标挪开后，让logo回到鼠标进入前的位置；
            });
        }

        // 使用缓动动画将 logo 移动到指定位置：
        var logoMoveStep = 0;

        var timeId = setInterval(function () {

            // 通过此公式使得 logoMoveStep 的值在每10毫秒增加一次，增加幅度为几何级别递减，最终无限趋向于 logoMoveToPosX 的值，体现出来的视觉效果就是由快到慢移动到 logoMoveToPosX 的位置；

            logoMoveStep = logoMoveStep + (logoMoveToPosX - logoMoveStep) * 0.2;
            console.log(+logoMoveStep);
            tmall_logo.style.left = logoMoveStep + 'px';

            // 若去除缓动效果，实则等于如下语句：
            // tmall_logo.style.left = logoMoveToPosX + 'px';
            // 最终要达到的目的，是把logo移到3个鼠标监听事件所指定的位置；

        }, 10); // 每10毫秒执行一次上面移动logo的语句，logoMoveToPosX 的值有变化的时候才会有视觉效果；

    });

</script>
</body>
</html>